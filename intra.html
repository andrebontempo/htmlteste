<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Page Title</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
    <script src='main.js'></script>
</head>
<body>
    
</script>
<style type="text/css">#chatbot-button {
    position: fixed;
    bottom: 24px;
    right: 24px;
    background-color: #09184f;
    border: none;
    border-radius: 50%;
    width: 64px;
    height: 64px;
    cursor: pointer;
    z-index: 9999;
    background-image: url('https://transfer.sede.embrapa.br/transfer/cst/chatbot/flora2024/Flora_Widget_003.png');
    background-size: 60%;
    background-position: center;
    background-repeat: no-repeat;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  }

  #chatbot-iframe {
    display: none;
    position: fixed;
    bottom: 100px;
    right: 24px;
    width: 400px;
    height: 560px;
    border: 1px solid #ccc;
    border-radius: 12px;
    z-index: 9998;
    box-shadow: 0 4px 16px rgba(0,0,0,0.25);
  }

  @media (max-width: 768px) {
    #chatbot-iframe {
      width: 95%;
      right: 2.5%;
      height: 80%;
      bottom: 90px;
    }
  }
</style>
<script type="text/javascript">
AUI().use('array-extras', function(A) {
    (function() {
        Liferay.Service(
            [
                {
                    '$user[userId,emailAddress,fullName] = /user/get-user-by-id': {
                        userId: Liferay.ThemeDisplay.getUserId()
                    }
                }
            ],
            window.onload = function(obj) {
                const userEmail = obj[0].emailAddress;
                const fullName = obj[0].fullName;
                const matricula = '123456'; // substitua pelo valor real se poss√≠vel

                const chatbotUrl = `https://floraia-n8n.b.agro.rocks/webhook/chat?email=${encodeURIComponent(userEmail)}&nome=${encodeURIComponent(fullName)}&matricula=${encodeURIComponent(matricula)}`;

                const iframe = document.createElement('iframe');
                iframe.id = 'chatbot-iframe';
                iframe.src = chatbotUrl;
                document.body.appendChild(iframe);

                const button = document.createElement('button');
                button.id = 'chatbot-button';
                button.onclick = function () {
                    const iframe = document.getElementById('chatbot-iframe');
                    iframe.style.display = (iframe.style.display === 'none' || !iframe.style.display) ? 'block' : 'none';
                };
                document.body.appendChild(button);
            }
        );
    })();
});
</script>

</body>
</html>